<div class="requests-container">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <!-- Header Section -->
  <div class="requests-header">
    <div class="header-content">
      <div class="header-title">
        <h1>
          <i class="pi pi-inbox"></i>
          Gelen İstekler
        </h1>
        <p class="header-subtitle">
          Kullanıcı isteklerini yönetin ve yanıtlayın
        </p>
      </div>
      <div class="header-stats">
        <div class="stat-item">
          <span class="stat-number">{{ filteredRequests.length }}</span>
          <span class="stat-label">Toplam İstek</span>
        </div>
        <div class="stat-item pending">
          <span class="stat-number">{{ pendingCount }}</span>
          <span class="stat-label">Bekleyen</span>
        </div>
        <div class="stat-item approved">
          <span class="stat-number">{{ approvedCount }}</span>
          <span class="stat-label">Onaylanan</span>
        </div>
        <div class="stat-item rejected">
          <span class="stat-number">{{ rejectedCount }}</span>
          <span class="stat-label">Reddedilen</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filters-container">
      <div class="filter-group">
        <label class="filter-label">Durum:</label>
        <div class="filter-buttons">
          <button 
            *ngFor="let option of statusOptions" 
            [class.active]="selectedStatus === option.value"
            (click)="selectedStatus = option.value; onStatusChange()"
            class="filter-button"
          >
            {{ option.label }}
          </button>
        </div>
      </div>

      <div class="filter-group">
        <label class="filter-label">Öncelik:</label>
        <div class="filter-buttons">
          <button 
            *ngFor="let option of priorityOptions" 
            [class.active]="selectedPriority === option.value"
            (click)="selectedPriority = option.value; onPriorityChange()"
            class="filter-button"
          >
            {{ option.label }}
          </button>
        </div>
      </div>

      <div class="filter-group">
        <label class="filter-label">Tür:</label>
        <div class="filter-buttons">
          <button 
            *ngFor="let option of typeOptions" 
            [class.active]="selectedType === option.value"
            (click)="selectedType = option.value; onTypeChange()"
            class="filter-button"
          >
            {{ option.label }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Requests List -->
  <div class="requests-list">
    <div *ngIf="filteredRequests.length === 0" class="empty-state">
      <i class="pi pi-inbox empty-icon"></i>
      <h3>Henüz İstek Yok</h3>
      <p>Filtreleme kriterlerinize uygun istek bulunamadı.</p>
    </div>

    <div *ngFor="let request of filteredRequests" class="request-card">
      <div class="request-header">
        <div class="user-info">
          <p-avatar 
            [label]="request.userAvatar" 
            size="large" 
            shape="circle"
            [style]="{'background-color': '#3498db', 'color': '#ffffff'}"
          ></p-avatar>
          <div class="user-details">
            <h3 class="user-name">{{ request.userName }}</h3>
            <p class="user-email">{{ request.userEmail }}</p>
            <p class="user-department" *ngIf="request.department">{{ request.department }}</p>
          </div>
        </div>
        
        <div class="request-meta">
          <div class="request-type">
            <i [class]="getTypeIcon(request.requestType)"></i>
            <span>{{ getTypeLabel(request.requestType) }}</span>
          </div>
          <div class="request-date">
            {{ request.requestDate | date:'dd MMM yyyy' }}
          </div>
        </div>
      </div>

      <div class="request-content">
        <h4 class="request-title">{{ request.requestTitle }}</h4>
        <p class="request-description">{{ request.requestDescription }}</p>
      </div>

      <div class="request-footer">
        <div class="request-tags">
          <p-tag 
            [value]="getStatusLabel(request.status)" 
            [severity]="getStatusColor(request.status)"
          ></p-tag>
          <p-tag 
            [value]="getPriorityLabel(request.priority)" 
            [severity]="getPriorityColor(request.priority)"
          ></p-tag>
        </div>

        <div class="request-actions" *ngIf="request.status === 'pending'">
          <p-button 
            label="Onayla" 
            icon="pi pi-check" 
            severity="success" 
            size="small"
            (click)="approveRequest(request)"
            [pTooltip]="'İsteği onayla'"
          ></p-button>
          <p-button 
            label="Reddet" 
            icon="pi pi-times" 
            severity="danger" 
            size="small"
            [outlined]="true"
            (click)="rejectRequest(request)"
            [pTooltip]="'İsteği reddet'"
          ></p-button>
        </div>

        <div class="request-status" *ngIf="request.status !== 'pending'">
          <i 
            [class]="request.status === 'approved' ? 'pi pi-check-circle text-success' : 'pi pi-times-circle text-danger'"
          ></i>
          <span [class]="request.status === 'approved' ? 'text-success' : 'text-danger'">
            {{ getStatusLabel(request.status) }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
